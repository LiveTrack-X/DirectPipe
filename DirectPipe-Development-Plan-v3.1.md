# DirectPipe â€” USB ë§ˆì´í¬ VST í˜¸ìŠ¤íŠ¸ + ì´ˆì €ì§€ì—° ë£¨í”„ë°± ì‹œìŠ¤í…œ

## ê°œë°œ ê³„íšì„œ v3.1

> **ëª©í‘œ:** USB ë§ˆì´í¬ ì‚¬ìš©ìê°€ í•˜ë“œì›¨ì–´ ì˜¤ì¸í˜ ì—†ì´ VST2/VST3 í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©í•˜ê³ ,  
> "Virtual Loop Mic" ê°€ìƒ ë§ˆì´í¬ë¥¼ í†µí•´ ëª¨ë“  ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¬ì¸ì› ì†Œí”„íŠ¸ì›¨ì–´  
> Light Host ìˆ˜ì¤€ì˜ VST í˜¸í™˜ì„± + ê¸°ì¡´ ëŒ€ë¹„ 50~60% ë ˆì´í„´ì‹œ ê°ì†Œ  
> í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤, MIDI, Stream Deckìœ¼ë¡œ ì‹¤ì‹œê°„ ì œì–´ ê°€ëŠ¥

---

## 1. í•µì‹¬ ì»¨ì…‰

### 1.1 ì‚¬ìš©ì ê´€ì 

```
[Before]
USB Mic â†’ Light Host â†’ VB-Cable â†’ Discord/OBS  (40~60ms ë”œë ˆì´)

[After]
USB Mic â†’ DirectPipe â†’ "Virtual Loop Mic" â†’ Discord/OBS  (13~23ms ë”œë ˆì´)
                â†‘
     í‚¤ë³´ë“œ/MIDI/StreamDeckìœ¼ë¡œ ì‹¤ì‹œê°„ ì œì–´
```

### 1.2 Light Hostì™€ì˜ ë¹„êµ

| í•­ëª© | Light Host + VB-Cable | DirectPipe |
|------|----------------------|------------|
| VST2 ì§€ì› | âœ… | âœ… |
| VST3 ì§€ì› | âœ… | âœ… |
| ê°€ìƒ ë§ˆì´í¬ | VB-Cable ë³„ë„ ì„¤ì¹˜ | **ë‚´ì¥ (Virtual Loop Mic)** |
| ë ˆì´í„´ì‹œ | 40~60ms | **13~23ms** |
| WASAPI ë²„í¼ ê²½ìœ  | 4~5ë‹¨ | **2ë‹¨** |
| ì„¤ì • ë³µì¡ë„ | VB-Cable + Light Host ë³„ë„ ì„¤ì • | **ì›í´ë¦­** |
| ëª¨ë…¸/ìŠ¤í…Œë ˆì˜¤ | ìë™ | **ì„ íƒ ê°€ëŠ¥** |
| ìƒ˜í”Œë ˆì´íŠ¸ | ê³ ì • | **ì„ íƒ ê°€ëŠ¥** |
| ë²„í¼ ì‚¬ì´ì¦ˆ | ê³ ì • | **ì„ íƒ ê°€ëŠ¥** |
| ì™¸ë¶€ ì œì–´ | âŒ | **ë‹¨ì¶•í‚¤ + MIDI + Stream Deck** |

### 1.3 ë ˆì´í„´ì‹œ ìƒì„¸

```
[ê¸°ì¡´: Light Host + VB-Cable â€” WASAPI 4~5ë‹¨]
USB Mic â†’ WASAPI Shared (~10ms) â†’ Light Host ë‚´ë¶€ (~10ms)
  â†’ WASAPI Out â†’ VB-Cable â†’ WASAPI In (~20ms) â†’ ì•±
ì´: ~40~60ms

[DirectPipe â€” WASAPI 2ë‹¨ + ê³µìœ  ë©”ëª¨ë¦¬ ì§ê²°]
USB Mic â†’ WASAPI Shared (~10ms) â†’ VST ì¸ë¼ì¸ (~0ms)
  â†’ ê³µìœ  ë©”ëª¨ë¦¬ (~0.05ms) â†’ ë“œë¼ì´ë²„ (~2ms) â†’ ì•± WASAPI In (~10ms)
ì´: ~21~23ms
```

**ë²„í¼ ì‚¬ì´ì¦ˆë³„:**

| ë²„í¼ (samples @48kHz) | ms | ê¸°ì¡´ | DirectPipe | ì ˆê° |
|----------------------|-----|------|-----------|------|
| 480 (ê¸°ë³¸) | 10ms | ~50ms | ~23ms | **54%â†“** |
| 256 | 5.3ms | ~35ms | ~13ms | **63%â†“** |
| 128 | 2.7ms | ~28ms | ~8ms | **71%â†“** |
| 64 | 1.3ms | ~22ms | ~5ms | **77%â†“** |

---

## 2. ì™¸ë¶€ ì œì–´ ì‹œìŠ¤í…œ (v3.1 ì¶”ê°€)

### 2.1 ì œì–´ ê°€ëŠ¥í•œ ì•¡ì…˜ ëª©ë¡

```
[í”ŒëŸ¬ê·¸ì¸ ì œì–´]
- Plugin 1 Bypass í† ê¸€
- Plugin 2 Bypass í† ê¸€
- Plugin N Bypass í† ê¸€
- ì „ì²´ ì²´ì¸ Bypass (ë§ˆìŠ¤í„° ë°”ì´íŒ¨ìŠ¤)
- ì „ì²´ ì²´ì¸ Mute

[ë³¼ë¥¨ ì œì–´]
- ì…ë ¥ ê²Œì¸ Up/Down (1dB ë‹¨ìœ„)
- Virtual Loop Mic ë³¼ë¥¨ Up/Down
- Monitor ë³¼ë¥¨ Up/Down
- Monitor Mute í† ê¸€

[í”„ë¦¬ì…‹]
- í”„ë¦¬ì…‹ 1~8 ì¦‰ì‹œ ì „í™˜
- ë‹¤ìŒ í”„ë¦¬ì…‹ / ì´ì „ í”„ë¦¬ì…‹

[ìœ í‹¸ë¦¬í‹°]
- ì „ì²´ ë®¤íŠ¸ (íŒ¨ë‹‰ ë²„íŠ¼, ëª¨ë“  ì¶œë ¥ ì¦‰ì‹œ ë¬´ìŒ)
- ë§ˆì´í¬ ì…ë ¥ Mute í† ê¸€
```

### 2.2 ì œì–´ ë°©ì‹ 1: ê¸€ë¡œë²Œ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤

```
êµ¬í˜„: Windows RegisterHotKey API
â†’ DirectPipeê°€ ë°±ê·¸ë¼ìš´ë“œ/ìµœì†Œí™” ìƒíƒœì—ì„œë„ ë™ì‘

ê¸°ë³¸ ë‹¨ì¶•í‚¤ (ì‚¬ìš©ì ë³€ê²½ ê°€ëŠ¥):
- Ctrl+Shift+1     â†’ Plugin 1 Bypass í† ê¸€
- Ctrl+Shift+2     â†’ Plugin 2 Bypass í† ê¸€
- Ctrl+Shift+3     â†’ Plugin 3 Bypass í† ê¸€
- ...
- Ctrl+Shift+0     â†’ ì „ì²´ ì²´ì¸ Bypass
- Ctrl+Shift+M     â†’ ì „ì²´ ë®¤íŠ¸ (íŒ¨ë‹‰ ë²„íŠ¼)
- Ctrl+Shift+â†‘/â†“   â†’ ì…ë ¥ ê²Œì¸ Up/Down
- Ctrl+Shift+F1~F8 â†’ í”„ë¦¬ì…‹ 1~8 ì „í™˜

ì»¤ìŠ¤í…€ ì„¤ì •:
- UIì—ì„œ "ë‹¨ì¶•í‚¤ ì„¤ì •" ë²„íŠ¼ â†’ ë‹¨ì¶•í‚¤ ë…¹í™” ë°©ì‹
- ì¶©ëŒ ê°ì§€ (ë‹¤ë¥¸ ì•±ê³¼ ê²¹ì¹˜ëŠ” ê²½ìš° ê²½ê³ )
- JSONìœ¼ë¡œ ì €ì¥/ë³µì›
```

### 2.3 ì œì–´ ë°©ì‹ 2: MIDI CC ë§¤í•‘

```
êµ¬í˜„: JUCE MidiInput (Windows MME / WinRT MIDI)
â†’ MIDI ì»¨íŠ¸ë¡¤ëŸ¬, MIDI í‚¤ë³´ë“œ, nanoKONTROL ë“±

ë™ì‘ ë°©ì‹:
- MIDI Learn: ë²„íŠ¼ í´ë¦­ â†’ "MIDI ì‹ í˜¸ë¥¼ ë³´ë‚´ì„¸ìš”" â†’ ìˆ˜ì‹ ëœ CCë¥¼ ë§¤í•‘
- CC ê°’ 0~63 = OFF, 64~127 = ON (í† ê¸€)
- CC ê°’ 0~127 = ì—°ì† (ë³¼ë¥¨ ë“±ì— ë§¤í•‘ ì‹œ)

ë§¤í•‘ ì˜ˆì‹œ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIDI Mapping                                â”‚
â”‚                                              â”‚
â”‚ Action              MIDI        Status       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Plugin 1 Bypass     CC#21 Ch1   [Learn] [âœ•] â”‚
â”‚ Plugin 2 Bypass     CC#22 Ch1   [Learn] [âœ•] â”‚
â”‚ Master Bypass       CC#30 Ch1   [Learn] [âœ•] â”‚
â”‚ Input Gain          CC#7  Ch1   [Learn] [âœ•] â”‚
â”‚ Monitor Volume      CC#11 Ch1   [Learn] [âœ•] â”‚
â”‚ Panic Mute          Note C1     [Learn] [âœ•] â”‚
â”‚                                              â”‚
â”‚ MIDI Device: [nanoKONTROL2 â–¼]              â”‚
â”‚                     [+ Add Mapping]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MIDI ë§¤í•‘ íƒ€ì…:
- CC Toggle: CC ê°’ 64+ â†’ ON, <64 â†’ OFF (ë²„íŠ¼ìš©)
- CC Momentary: CC ê°’ 64+ ëˆ„ë¥¸ ë™ì•ˆ ON (í’‹ìŠ¤ìœ„ì¹˜ìš©)
- CC Continuous: 0~127 â†’ 0%~100% (í˜ì´ë”/ë…¸ë¸Œìš©)
- Note On/Off: ë…¸íŠ¸ í‚¤ë¡œ í† ê¸€ (MIDI í‚¤ë³´ë“œìš©)
```

### 2.4 ì œì–´ ë°©ì‹ 3: Stream Deck (Elgato)

```
êµ¬í˜„: WebSocket ì„œë²„ (DirectPipe ë‚´ì¥)
â†’ Stream Deck í”ŒëŸ¬ê·¸ì¸ì´ WebSocketìœ¼ë¡œ ì—°ê²°
â†’ ë˜ëŠ” Stream Deckì˜ "Website" ì•¡ì…˜ìœ¼ë¡œ HTTP í˜¸ì¶œ

êµ¬ì¡°:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     WebSocket      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stream Deck  â”‚ â†â”€â”€ :8765 â”€â”€â”€â”€â”€â”€â†’ â”‚ DirectPipe          â”‚
â”‚ Plugin       â”‚                     â”‚ WebSocket Server    â”‚
â”‚              â”‚ {"action":"bypass", â”‚ (ë‚´ì¥, ìë™ ì‹œì‘)   â”‚
â”‚              â”‚  "plugin":1}        â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WebSocket í”„ë¡œí† ì½œ (JSON):

ìš”ì²­ (Stream Deck â†’ DirectPipe):
{
  "type": "action",
  "action": "plugin_bypass",
  "params": { "index": 1 }
}
{
  "type": "action",
  "action": "set_volume",
  "params": { "target": "monitor", "value": 0.5 }
}
{
  "type": "action",
  "action": "load_preset",
  "params": { "index": 3 }
}
{
  "type": "action",
  "action": "panic_mute"
}

ì‘ë‹µ (DirectPipe â†’ Stream Deck):
{
  "type": "state",
  "data": {
    "plugins": [
      {"name": "ReaEQ", "bypass": false},
      {"name": "W1 Limiter", "bypass": true}
    ],
    "volumes": {"input": 0.8, "virtual_mic": 1.0, "monitor": 0.7},
    "muted": false,
    "preset": "ë°©ì†¡ìš©",
    "latency_ms": 23.1,
    "level_db": -12.3
  }
}

ìƒíƒœ Push (DirectPipe â†’ Stream Deck, ë³€ê²½ ì‹œ ìë™):
â†’ bypass ìƒíƒœ ë³€ê²½ ì‹œ ì¦‰ì‹œ push
â†’ Stream Deck ë²„íŠ¼ ì•„ì´ì½˜ ìë™ ì—…ë°ì´íŠ¸ (ON/OFF í‘œì‹œ)

Stream Deck í”ŒëŸ¬ê·¸ì¸ (ë³„ë„ ê°œë°œ):
- Elgato SDK (Node.js ê¸°ë°˜)ë¡œ ì œì‘
- ë²„íŠ¼ íƒ€ì…:
  - Plugin Bypass (í† ê¸€, ìƒíƒœ í‘œì‹œ)
  - Volume Control (ê¸¸ê²Œ ëˆ„ë¥´ë©´ Up, ì§§ê²Œ ëˆ„ë¥´ë©´ í† ê¸€)
  - Preset Switch (í”„ë¦¬ì…‹ ë²ˆí˜¸ í‘œì‹œ)
  - Panic Mute (ë¹¨ê°„ ë²„íŠ¼)
  - Level Meter (ì‹¤ì‹œê°„ ë ˆë²¨ í‘œì‹œ)

ëŒ€ì•ˆ (í”ŒëŸ¬ê·¸ì¸ ì—†ì´):
- Stream Deckì˜ "Open Website" ì•¡ì…˜ìœ¼ë¡œ HTTP endpoint í˜¸ì¶œ
- DirectPipeê°€ ê°„ë‹¨í•œ HTTP ì„œë²„ë„ ì œê³µ:
  GET http://localhost:8766/api/bypass/1/toggle
  GET http://localhost:8766/api/mute/toggle
  GET http://localhost:8766/api/preset/3
```

### 2.5 ì™¸ë¶€ ì œì–´ í†µí•© ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                DirectPipe Application                     â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Control Manager                        â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚  â”‚
â”‚  â”‚  â”‚ Hotkey       â”‚â”€â”€â”                                â”‚  â”‚
â”‚  â”‚  â”‚ Handler      â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚  â”‚ (WinAPI)     â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”œâ”€â”€â”€â†’â”‚  Action Dispatcher   â”‚    â”‚  â”‚
â”‚  â”‚                     â”‚    â”‚                       â”‚    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  ëª¨ë“  ì†ŒìŠ¤ì—ì„œ ì˜¨     â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ MIDI         â”‚â”€â”€â”¤    â”‚  ì•¡ì…˜ì„ í†µì¼ ì²˜ë¦¬     â”‚â”€â”€â”€â†’â”‚â”€â”€â”‚â”€â”€â†’ AudioEngine
â”‚  â”‚  â”‚ Handler      â”‚  â”‚    â”‚                       â”‚    â”‚  â”‚    VSTChain
â”‚  â”‚  â”‚ (JUCE MIDI)  â”‚  â”‚    â”‚  ì•¡ì…˜ ì¢…ë¥˜:           â”‚    â”‚  â”‚    OutputRouter
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  - PluginBypass(n)    â”‚    â”‚  â”‚
â”‚  â”‚                     â”‚    â”‚  - MasterBypass       â”‚    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  - SetVolume(t,v)     â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ WebSocket    â”‚â”€â”€â”¤    â”‚  - ToggleMute(t)      â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ Server       â”‚  â”‚    â”‚  - LoadPreset(n)      â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ (Stream Deck)â”‚  â”‚    â”‚  - PanicMute          â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                     â”‚                                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                â”‚  â”‚
â”‚  â”‚  â”‚ HTTP API     â”‚â”€â”€â”˜                                â”‚  â”‚
â”‚  â”‚  â”‚ (ê°„ë‹¨ REST)  â”‚                                   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              State Broadcaster                      â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  ìƒíƒœ ë³€ê²½ ì‹œ ëª¨ë“  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì— push:         â”‚  â”‚
â”‚  â”‚  â†’ WebSocket í´ë¼ì´ì–¸íŠ¸ (Stream Deck)               â”‚  â”‚
â”‚  â”‚  â†’ GUI ì—…ë°ì´íŠ¸                                      â”‚  â”‚
â”‚  â”‚  â†’ MIDI í”¼ë“œë°± (LED ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬)                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.6 ì œì–´ ì„¤ì • UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ Control Settings                           âœ•      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  [Hotkeys] [MIDI] [Stream Deck]                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                        â”‚
â”‚  HOTKEYS                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Action              Shortcut         [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚ Plugin 1 Bypass     Ctrl+Shift+1     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Plugin 2 Bypass     Ctrl+Shift+2     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Plugin 3 Bypass     (ì—†ìŒ)           [Set]        â”‚ â”‚
â”‚  â”‚ Master Bypass       Ctrl+Shift+0     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Panic Mute          Ctrl+Shift+M     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Input Gain Up       Ctrl+Shift+â†‘     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Input Gain Down     Ctrl+Shift+â†“     [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Preset 1            Ctrl+Shift+F1    [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚ Preset 2            Ctrl+Shift+F2    [Set] [âœ•]   â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚ [Set] í´ë¦­ â†’ "ë‹¨ì¶•í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”..." â†’ ë…¹í™”       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  MIDI                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ MIDI Device: [nanoKONTROL2 â–¼]  ğŸŸ¢ Connected     â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚ Action              MIDI          Type             â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚ Plugin 1 Bypass     CC#21 Ch1     Toggle  [Learn] â”‚ â”‚
â”‚  â”‚ Plugin 2 Bypass     CC#22 Ch1     Toggle  [Learn] â”‚ â”‚
â”‚  â”‚ Input Gain          CC#7  Ch1     Continuous       â”‚ â”‚
â”‚  â”‚ Monitor Volume      CC#11 Ch1     Continuous       â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚ [Learn] í´ë¦­ â†’ "MIDI ì‹ í˜¸ë¥¼ ë³´ë‚´ì„¸ìš”..." â†’ ë§¤í•‘  â”‚ â”‚
â”‚  â”‚                     [+ Add Mapping]                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  STREAM DECK                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ WebSocket: ws://localhost:8765  ğŸŸ¢ Running        â”‚ â”‚
â”‚  â”‚ HTTP API:  http://localhost:8766 ğŸŸ¢ Running       â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚ Connected Clients: 1                               â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚ [Stream Deck í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ ê°€ì´ë“œ...]             â”‚ â”‚
â”‚  â”‚ [API ë¬¸ì„œ ì—´ê¸°...]                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚                              [Save] [Cancel]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (v3.1)

### 3.1 ì „ì²´ êµ¬ì¡°

```
                    ì™¸ë¶€ ì œì–´
          â”Œâ”€â”€â”€â”€ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ (Global Hotkey)
          â”œâ”€â”€â”€â”€ MIDI CC (nanoKONTROL, í‚¤ë³´ë“œ ë“±)
          â”œâ”€â”€â”€â”€ Stream Deck (WebSocket)
          â”œâ”€â”€â”€â”€ HTTP API (ë²”ìš©)
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DirectPipe Application                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚  â”‚ Control      â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Manager      â”‚â”€â”€â†’â”‚ Action        â”‚â”€â”€â†’â”‚ AudioEngine           â”‚  â”‚
â”‚  â”‚              â”‚   â”‚ Dispatcher    â”‚   â”‚ VSTChain              â”‚  â”‚
â”‚  â”‚ Hotkey       â”‚   â”‚               â”‚   â”‚ OutputRouter          â”‚  â”‚
â”‚  â”‚ MIDI         â”‚   â”‚ í†µì¼ëœ ì•¡ì…˜   â”‚   â”‚                       â”‚  â”‚
â”‚  â”‚ WebSocket    â”‚   â”‚ ì¸í„°í˜ì´ìŠ¤    â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ HTTP         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ SharedMem Writerâ”‚â”€â”€â”€â”‚â”€â”€â”‚â”€â”€â”
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚
â”‚                              â”‚            â”‚                       â”‚  â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚
â”‚  â”‚ State        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚ Monitor Output  â”‚â”€â”€â”€â”‚â”€â”€â”‚â”€â”€â”‚â”€â”€â†’ í—¤ë“œí°
â”‚  â”‚ Broadcaster  â”‚                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚
â”‚  â”‚              â”‚â”€â”€â†’ GUI ì—…ë°ì´íŠ¸        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚              â”‚â”€â”€â†’ WebSocket push                                  â”‚  â”‚
â”‚  â”‚              â”‚â”€â”€â†’ MIDI LED í”¼ë“œë°±                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚  â”‚
â”‚                                                                      â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚  â”‚
â”‚  â”‚ Audio Input  â”‚â”€â”€â†’â”‚ VST Chain     â”‚                               â”‚  â”‚
â”‚  â”‚ WASAPI Sharedâ”‚   â”‚ VST2 / VST3  â”‚â”€â”€â†’ OutputRouter               â”‚  â”‚
â”‚  â”‚ SR/Buffer/Ch â”‚   â”‚ Bypass ê°œë³„   â”‚                               â”‚  â”‚
â”‚  â”‚ ì„ íƒ ê°€ëŠ¥    â”‚   â”‚ ì™¸ë¶€ì œì–´ ê°€ëŠ¥ â”‚                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                                                          â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚              Virtual Loop Mic Driver (Kernel, WDM)                 â”‚   â”‚
  â”‚  ê³µìœ  ë©”ëª¨ë¦¬ì—ì„œ PCM ì½ê¸° â†’ "Virtual Loop Mic" ìœ¼ë¡œ ë…¸ì¶œ          â”‚â—„â”€â”€â”˜
  â”‚  ëª¨ë“  ì•±ì—ì„œ ì¼ë°˜ ë§ˆì´í¬ë¡œ ì„ íƒ ê°€ëŠ¥                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ë°ì´í„° í”Œë¡œìš°

```
[ì˜¤ë””ì˜¤ ì½œë°± â€” ì‹¤ì‹œê°„ ìŠ¤ë ˆë“œ]

1. WASAPI Shared ì½œë°± (ë²„í¼: ì‚¬ìš©ì ì„ íƒ, ê¸°ë³¸ 480 samples)
2. ì±„ë„ ì²˜ë¦¬ (Mono ë˜ëŠ” Stereo, ì‚¬ìš©ì ì„ íƒ)
3. VST2/VST3 ì²´ì¸ processBlock() ì¸ë¼ì¸
   - ê° í”ŒëŸ¬ê·¸ì¸ bypass ìƒíƒœëŠ” ì™¸ë¶€ì—ì„œ ì‹¤ì‹œê°„ ë³€ê²½ ê°€ëŠ¥
   - bypass í† ê¸€ì€ atomic flagë¡œ lock-free ì²˜ë¦¬
4. ì¶œë ¥ ë¶„ë°°:
   a. ê³µìœ  ë©”ëª¨ë¦¬ â†’ Virtual Loop Mic
   b. WASAPI ì¶œë ¥ â†’ í—¤ë“œí° ëª¨ë‹ˆí„°
5. Named Event ì‹œê·¸ë„

[ì œì–´ ì´ë²¤íŠ¸ â€” ë¹„ë™ê¸°, ë©”ì¸ ìŠ¤ë ˆë“œ]
- Hotkey/MIDI/WebSocket â†’ Action Dispatcher â†’ atomic flag ë³€ê²½
- ì˜¤ë””ì˜¤ ìŠ¤ë ˆë“œëŠ” ë‹¤ìŒ ì½œë°±ì—ì„œ ë³€ê²½ëœ flag ë°˜ì˜
- lock-free: ì œì–´ ì´ë²¤íŠ¸ê°€ ì˜¤ë””ì˜¤ë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•ŠìŒ
```

---

## 4. ë””ë ‰í† ë¦¬ êµ¬ì¡° (v3.1)

```
directpipe/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ CLAUDE.md
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ core/                              # ê³µìœ  IPC ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â”œâ”€â”€ include/directpipe/
â”‚   â”‚   â”œâ”€â”€ RingBuffer.h
â”‚   â”‚   â”œâ”€â”€ SharedMemory.h
â”‚   â”‚   â”œâ”€â”€ Protocol.h
â”‚   â”‚   â””â”€â”€ Constants.h
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ RingBuffer.cpp
â”‚       â””â”€â”€ SharedMemory.cpp
â”‚
â”œâ”€â”€ host/                              # JUCE VST Host ì•±
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â”œâ”€â”€ Source/
â”‚   â”‚   â”œâ”€â”€ Main.cpp
â”‚   â”‚   â”œâ”€â”€ MainComponent.h/cpp
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Audio/
â”‚   â”‚   â”‚   â”œâ”€â”€ AudioEngine.h/cpp
â”‚   â”‚   â”‚   â”œâ”€â”€ VSTChain.h/cpp
â”‚   â”‚   â”‚   â”œâ”€â”€ OutputRouter.h/cpp
â”‚   â”‚   â”‚   â””â”€â”€ LatencyMonitor.h/cpp
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ IPC/
â”‚   â”‚   â”‚   â””â”€â”€ SharedMemWriter.h/cpp
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Control/                   # â† v3.1 ì¶”ê°€
â”‚   â”‚   â”‚   â”œâ”€â”€ ControlManager.h/cpp   # ëª¨ë“  ì™¸ë¶€ ì…ë ¥ í†µí•© ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ ActionDispatcher.h/cpp # ì•¡ì…˜ â†’ ì˜¤ë””ì˜¤ ì—”ì§„ ì „ë‹¬
â”‚   â”‚   â”‚   â”œâ”€â”€ StateBroadcaster.h/cpp # ìƒíƒœ ë³€ê²½ â†’ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ push
â”‚   â”‚   â”‚   â”œâ”€â”€ HotkeyHandler.h/cpp    # Windows Global Hotkey
â”‚   â”‚   â”‚   â”œâ”€â”€ MidiHandler.h/cpp      # MIDI CC ë§¤í•‘ + Learn
â”‚   â”‚   â”‚   â”œâ”€â”€ WebSocketServer.h/cpp  # Stream Deck WebSocket
â”‚   â”‚   â”‚   â”œâ”€â”€ HttpApiServer.h/cpp    # ê°„ë‹¨ REST API
â”‚   â”‚   â”‚   â””â”€â”€ ControlMapping.h/cpp   # ë§¤í•‘ ì €ì¥/ë¡œë“œ (JSON)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ UI/
â”‚   â”‚       â”œâ”€â”€ DeviceSelector.h/cpp
â”‚   â”‚       â”œâ”€â”€ AudioSettings.h/cpp
â”‚   â”‚       â”œâ”€â”€ PluginChainEditor.h/cpp
â”‚   â”‚       â”œâ”€â”€ PluginScanner.h/cpp
â”‚   â”‚       â”œâ”€â”€ LevelMeter.h/cpp
â”‚   â”‚       â”œâ”€â”€ OutputPanel.h/cpp
â”‚   â”‚       â”œâ”€â”€ PresetManager.h/cpp
â”‚   â”‚       â”œâ”€â”€ ControlSettingsPanel.h/cpp  # â† v3.1 ì¶”ê°€
â”‚   â”‚       â””â”€â”€ LookAndFeel.h/cpp
â”‚   â””â”€â”€ Resources/
â”‚
â”œâ”€â”€ streamdeck-plugin/                 # â† v3.1 ì¶”ê°€ (ì„ íƒì )
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ manifest.json                  # Stream Deck í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆí˜ìŠ¤íŠ¸
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ plugin.js                  # ë©”ì¸ í”ŒëŸ¬ê·¸ì¸ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ actions/
â”‚   â”‚   â”‚   â”œâ”€â”€ bypass-toggle.js       # ë°”ì´íŒ¨ìŠ¤ í† ê¸€ ì•¡ì…˜
â”‚   â”‚   â”‚   â”œâ”€â”€ volume-control.js      # ë³¼ë¥¨ ì œì–´ ì•¡ì…˜
â”‚   â”‚   â”‚   â”œâ”€â”€ preset-switch.js       # í”„ë¦¬ì…‹ ì „í™˜ ì•¡ì…˜
â”‚   â”‚   â”‚   â””â”€â”€ panic-mute.js          # íŒ¨ë‹‰ ë®¤íŠ¸ ì•¡ì…˜
â”‚   â”‚   â””â”€â”€ websocket-client.js        # DirectPipe ì—°ê²°
â”‚   â””â”€â”€ images/                        # Stream Deck ë²„íŠ¼ ì•„ì´ì½˜
â”‚       â”œâ”€â”€ bypass-on.png
â”‚       â”œâ”€â”€ bypass-off.png
â”‚       â”œâ”€â”€ mute.png
â”‚       â””â”€â”€ preset.png
â”‚
â”œâ”€â”€ driver/                            # Virtual Loop Mic ë“œë¼ì´ë²„
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ virtualloop.vcxproj
â”‚   â”œâ”€â”€ inf/virtualloop.inf
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ adapter.cpp
â”‚   â”‚   â”œâ”€â”€ miniport.cpp
â”‚   â”‚   â”œâ”€â”€ stream.cpp
â”‚   â”‚   â””â”€â”€ shm_kernel_reader.cpp
â”‚   â””â”€â”€ test/driver_test.cpp
â”‚
â”œâ”€â”€ installer/
â”‚   â”œâ”€â”€ directpipe.iss
â”‚   â””â”€â”€ install-driver.ps1
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â”œâ”€â”€ test_ring_buffer.cpp
â”‚   â”œâ”€â”€ test_shared_memory.cpp
â”‚   â”œâ”€â”€ test_latency.cpp
â”‚   â”œâ”€â”€ test_ipc_integration.cpp
â”‚   â”œâ”€â”€ test_action_dispatcher.cpp     # â† v3.1 ì¶”ê°€
â”‚   â””â”€â”€ test_websocket_protocol.cpp    # â† v3.1 ì¶”ê°€
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ ARCHITECTURE.md
    â”œâ”€â”€ BUILDING.md
    â”œâ”€â”€ USER_GUIDE.md
    â”œâ”€â”€ CONTROL_API.md                 # â† v3.1 ì¶”ê°€ (WebSocket/HTTP API ë¬¸ì„œ)
    â””â”€â”€ STREAMDECK_GUIDE.md            # â† v3.1 ì¶”ê°€
```

---

## 5. ê°œë°œ Phase (v3.1)

### Phase 0: í™˜ê²½ ì„¤ì • (Day 1)

```
íƒœìŠ¤í¬:
â–¡ P0-1: CMake í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
â–¡ P0-2: JUCE 7 submodule ì¶”ê°€
â–¡ P0-3: VST2 SDK ì„¤ì • (JUCE_PLUGINHOST_VST=1)
â–¡ P0-4: WDK ì„¤ì¹˜
â–¡ P0-5: CLAUDE.md ì‘ì„±
â–¡ P0-6: ë¹Œë“œ ê²€ì¦
```

### Phase 1: Core IPC (Day 2~4)

```
íƒœìŠ¤í¬:
â–¡ P1-1: Protocol.h â€” SharedHeader êµ¬ì¡°ì²´
â–¡ P1-2: RingBuffer.h/cpp â€” SPSC lock-free
â–¡ P1-3: SharedMemory.h/cpp â€” Windows shared memory + Named Event
â–¡ P1-4: Constants.h
â–¡ P1-5: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

ì‚°ì¶œë¬¼: directpipe-core ë¼ì´ë¸ŒëŸ¬ë¦¬
```

### Phase 2: ì˜¤ë””ì˜¤ ì—”ì§„ + VST í˜¸ìŠ¤íŠ¸ (Day 5~10)

```
íƒœìŠ¤í¬:
â–¡ P2-1: AudioEngine â€” WASAPI Shared, SR/Buffer/Channel ì„ íƒ ê°€ëŠ¥
â–¡ P2-2: ì±„ë„ ì²˜ë¦¬ â€” Mono/Stereo ì„ íƒ
â–¡ P2-3: VSTChain â€” VST2 + VST3, Light Host ìˆ˜ì¤€
         - ê° í”ŒëŸ¬ê·¸ì¸ì— atomic<bool> bypassFlag
         - ì™¸ë¶€ì—ì„œ lock-freeë¡œ bypass í† ê¸€ ê°€ëŠ¥
â–¡ P2-4: OutputRouter â€” SharedMem + Monitor
â–¡ P2-5: LatencyMonitor
â–¡ P2-6: ì½˜ì†” í†µí•© í…ŒìŠ¤íŠ¸

ì‚°ì¶œë¬¼: GUI ì—†ì´ ë™ì‘í•˜ëŠ” ì˜¤ë””ì˜¤ ì—”ì§„
```

### Phase 3: Virtual Loop Mic ë“œë¼ì´ë²„ (Day 11~17)

```
íƒœìŠ¤í¬:
â–¡ P3-1: Sysvad í¬í¬ ë° ìµœì†Œí™” (Captureë§Œ)
â–¡ P3-2: ê³µìœ  ë©”ëª¨ë¦¬ Reader (ì»¤ë„ ëª¨ë“œ)
â–¡ P3-3: WDM ìŠ¤íŠ¸ë¦¼ â€” SR/Channel ìë™ ë§¤ì¹­
â–¡ P3-4: INF + ì„¤ì¹˜/ì œê±° ìŠ¤í¬ë¦½íŠ¸
â–¡ P3-5: í…ŒìŠ¤íŠ¸ ì„œëª… + Discord/Zoom í…ŒìŠ¤íŠ¸
â–¡ P3-6: ë‹¤ì¤‘ í´ë¼ì´ì–¸íŠ¸ + ì•ˆì •ì„± í…ŒìŠ¤íŠ¸

ì‚°ì¶œë¬¼: VirtualLoopMic.sys
```

### Phase 4: ì™¸ë¶€ ì œì–´ ì‹œìŠ¤í…œ (Day 18~22) â† v3.1 ì¶”ê°€

```
ëª©í‘œ: í‚¤ë³´ë“œ/MIDI/Stream Deckìœ¼ë¡œ VST bypass ë“± ì‹¤ì‹œê°„ ì œì–´

íƒœìŠ¤í¬:
â–¡ P4-1: ActionDispatcher â€” í†µì¼ëœ ì•¡ì…˜ ì¸í„°í˜ì´ìŠ¤

  enum class Action {
      PluginBypass,      // params: plugin_index
      MasterBypass,
      SetVolume,         // params: target, value (0.0~1.0)
      ToggleMute,        // params: target
      LoadPreset,        // params: preset_index
      PanicMute,         // ëª¨ë“  ì¶œë ¥ ì¦‰ì‹œ ë¬´ìŒ
      InputGainAdjust,   // params: delta_db (+1 or -1)
  };

  struct ActionEvent {
      Action action;
      int intParam = 0;
      float floatParam = 0.0f;
      std::string stringParam;
  };

  - dispatch(ActionEvent) â†’ AudioEngine/VSTChainì— ì „ë‹¬
  - ì˜¤ë””ì˜¤ ìŠ¤ë ˆë“œì™€ì˜ í†µì‹ : lock-free queue ë˜ëŠ” atomic flags
  - GUIì—ì„œë„ ê°™ì€ ActionDispatcher ì‚¬ìš© (í†µì¼)

â–¡ P4-2: StateBroadcaster â€” ìƒíƒœ ë³€ê²½ ì•Œë¦¼

  struct AppState {
      struct PluginState {
          std::string name;
          bool bypassed;
          bool loaded;
      };
      std::vector<PluginState> plugins;
      float inputGain;
      float virtualMicVolume;
      float monitorVolume;
      bool masterBypassed;
      bool muted;
      std::string currentPreset;
      float latencyMs;
      float inputLevelDb;
  };

  - ìƒíƒœ ë³€ê²½ ì‹œ ë¦¬ìŠ¤ë„ˆë“¤ì—ê²Œ push
  - ë¦¬ìŠ¤ë„ˆ: GUI, WebSocket í´ë¼ì´ì–¸íŠ¸, MIDI LED

â–¡ P4-3: HotkeyHandler â€” ê¸€ë¡œë²Œ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤

  êµ¬í˜„:
  - RegisterHotKey(hwnd, id, modifiers, vk) â€” Win32 API
  - ë©”ì‹œì§€ ë£¨í”„ì—ì„œ WM_HOTKEY ìˆ˜ì‹ 
  - JUCEì˜ ê²½ìš°: Timerë‚˜ AsyncUpdaterë¡œ ë©”ì¸ ìŠ¤ë ˆë“œ ì²˜ë¦¬
  - DirectPipe ìµœì†Œí™”/íŠ¸ë ˆì´ ìƒíƒœì—ì„œë„ ë™ì‘

  ê¸°ëŠ¥:
  - ì‚¬ìš©ì ì •ì˜ ë‹¨ì¶•í‚¤ ë“±ë¡/í•´ì œ
  - ì¶©ëŒ ê°ì§€ (RegisterHotKey ì‹¤íŒ¨ ì‹œ ì•Œë¦¼)
  - ì„¤ì • ì €ì¥/ë¡œë“œ (JSON)

  í…ŒìŠ¤íŠ¸:
  - ì•± í¬ì»¤ìŠ¤ ì—†ì„ ë•Œ hotkey ë™ì‘ í™•ì¸
  - ì—¬ëŸ¬ hotkey ë™ì‹œ ë“±ë¡/í•´ì œ
  - ì•± ì¢…ë£Œ ì‹œ hotkey ì •ë¦¬ í™•ì¸

â–¡ P4-4: MidiHandler â€” MIDI CC ë§¤í•‘

  êµ¬í˜„:
  - juce::MidiInputìœ¼ë¡œ MIDI ì¥ì¹˜ ì—´ê¸°
  - handleIncomingMidiMessage ì½œë°±
  - MIDI Learn ëª¨ë“œ:
    1. UIì—ì„œ [Learn] í´ë¦­ â†’ ë¦¬ìŠ¤ë‹ ëª¨ë“œ
    2. ì‚¬ìš©ìê°€ MIDI ì»¨íŠ¸ë¡¤ëŸ¬ ì¡°ì‘
    3. ìˆ˜ì‹ ëœ CC#/Channel ìë™ ë§¤í•‘
    4. ë§¤í•‘ ì €ì¥

  ë§¤í•‘ íƒ€ì…:
  - Toggle: CC â‰¥64 â†’ ON, CC <64 â†’ OFF
  - Momentary: CC â‰¥64 â†’ ON (ëˆ„ë¥´ëŠ” ë™ì•ˆ), CC <64 â†’ OFF
  - Continuous: CC 0~127 â†’ 0.0~1.0 (ë³¼ë¥¨/ê²Œì¸)
  - NoteOnOff: Note ON â†’ í† ê¸€

  ê¸°ëŠ¥:
  - ì—¬ëŸ¬ MIDI ì¥ì¹˜ ë™ì‹œ ì‚¬ìš©
  - ì¥ì¹˜ í•«í”ŒëŸ¬ê·¸ (ì—°ê²°/ë¶„ë¦¬ ê°ì§€)
  - MIDI í”¼ë“œë°± (LED ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬: bypass ON â†’ LED ON)
  - ë§¤í•‘ ì €ì¥/ë¡œë“œ (JSON)

â–¡ P4-5: WebSocketServer â€” Stream Deck ì—°ê²°

  êµ¬í˜„:
  - ê²½ëŸ‰ WebSocket ì„œë²„ (í¬íŠ¸ 8765)
  - ë¼ì´ë¸ŒëŸ¬ë¦¬: beast (Boost) ë˜ëŠ” IXWebSocket ë˜ëŠ” ì§ì ‘ êµ¬í˜„
  - JUCEì— ë‚´ì¥ëœ WebSocketì€ ì—†ìœ¼ë¯€ë¡œ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”
  - ì¶”ì²œ: cpp-httplib (HTTP) + IXWebSocket (WebSocket)
    ë˜ëŠ” uWebSockets (ê²½ëŸ‰, ê³ ì„±ëŠ¥)

  í”„ë¡œí† ì½œ:
  - JSON ê¸°ë°˜ ìš”ì²­/ì‘ë‹µ
  - ì•¡ì…˜ ìš”ì²­ â†’ ActionDispatcher
  - ìƒíƒœ push â†’ StateBroadcasterì—ì„œ ìë™

  ìë™ ì‹œì‘:
  - DirectPipe ì‹¤í–‰ ì‹œ WebSocket ì„œë²„ ìë™ ì‹œì‘
  - ì‹¤íŒ¨ ì‹œ í¬íŠ¸ ë³€ê²½ ì‹œë„ (8765 â†’ 8766 â†’ ...)

â–¡ P4-6: HttpApiServer â€” ê°„ë‹¨ REST API (Stream Deck ëŒ€ì•ˆ)

  êµ¬í˜„:
  - cpp-httplib ê¸°ë°˜ ê°„ë‹¨ HTTP ì„œë²„ (í¬íŠ¸ 8766)
  - Stream Deckì—ì„œ "Open Website" ì•¡ì…˜ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥

  ì—”ë“œí¬ì¸íŠ¸:
  GET /api/status                    â†’ ì „ì²´ ìƒíƒœ JSON
  GET /api/bypass/:index/toggle      â†’ í”ŒëŸ¬ê·¸ì¸ bypass í† ê¸€
  GET /api/bypass/master/toggle      â†’ ë§ˆìŠ¤í„° bypass
  GET /api/mute/toggle               â†’ ì „ì²´ ë®¤íŠ¸
  GET /api/mute/panic                â†’ íŒ¨ë‹‰ ë®¤íŠ¸
  GET /api/volume/:target/:value     â†’ ë³¼ë¥¨ ì„¤ì •
  GET /api/preset/:index             â†’ í”„ë¦¬ì…‹ ë¡œë“œ
  GET /api/gain/:delta               â†’ ì…ë ¥ ê²Œì¸ ì¡°ì ˆ

  ì¥ì : Stream Deck í”ŒëŸ¬ê·¸ì¸ ì—†ì´ë„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥

â–¡ P4-7: ControlMapping â€” ë§¤í•‘ ì €ì¥/ë¡œë“œ

  JSON íŒŒì¼: directpipe-controls.json
  {
    "hotkeys": [
      {"action": "plugin_bypass", "params": {"index": 1},
       "key": "Ctrl+Shift+1"},
      {"action": "panic_mute", "key": "Ctrl+Shift+M"}
    ],
    "midi": [
      {"action": "plugin_bypass", "params": {"index": 1},
       "device": "nanoKONTROL2", "type": "toggle",
       "cc": 21, "channel": 1},
      {"action": "set_volume", "params": {"target": "monitor"},
       "device": "nanoKONTROL2", "type": "continuous",
       "cc": 7, "channel": 1}
    ],
    "websocket": {"port": 8765, "enabled": true},
    "http": {"port": 8766, "enabled": true}
  }

â–¡ P4-8: ControlSettingsPanel UI
  - Hotkeys íƒ­: ë‹¨ì¶•í‚¤ ëª©ë¡ + [Set] + [âœ•]
  - MIDI íƒ­: MIDI ì¥ì¹˜ ì„ íƒ + ë§¤í•‘ ëª©ë¡ + [Learn]
  - Stream Deck íƒ­: ì—°ê²° ìƒíƒœ + í¬íŠ¸ + ê°€ì´ë“œ ë§í¬

â–¡ P4-9: í…ŒìŠ¤íŠ¸
  - Hotkey: ë°±ê·¸ë¼ìš´ë“œì—ì„œ bypass í† ê¸€ í™•ì¸
  - MIDI: nanoKONTROL (ë˜ëŠ” ê°€ìƒ MIDI) í…ŒìŠ¤íŠ¸
  - WebSocket: í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ë¡œ ì•¡ì…˜/ìƒíƒœ í™•ì¸
  - HTTP: curl/ë¸Œë¼ìš°ì €ë¡œ API í˜¸ì¶œ í™•ì¸
  - ë™ì‹œ ì œì–´: Hotkey + MIDI ë™ì‹œì— ê°™ì€ ì•¡ì…˜ â†’ ì¶©ëŒ ì—†ìŒ í™•ì¸

ì‚°ì¶œë¬¼:
- í‚¤ë³´ë“œ/MIDI/Stream Deckìœ¼ë¡œ VST bypass ë“± ì œì–´ ê°€ëŠ¥
- WebSocket/HTTP API ë™ì‘
```

### Phase 5: GUI (Day 23~27)

```
íƒœìŠ¤í¬:
â–¡ P5-1: ë©”ì¸ ìœˆë„ìš° ë ˆì´ì•„ì›ƒ

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ™ DirectPipe                     [âš™] â”€ â–¡ âœ•    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                    â”‚
  â”‚  INPUT                                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ ğŸ¤ [Blue Yeti â–¼]                            â”‚  â”‚
  â”‚  â”‚ â– â– â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡  -12.3 dB   Gain [====]    â”‚  â”‚
  â”‚  â”‚                                              â”‚  â”‚
  â”‚  â”‚ SR: [48000 â–¼] Buffer: [480 â–¼] Ch: [â—M][â—‹S] â”‚  â”‚
  â”‚  â”‚ Estimated Latency: ~23ms                     â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                    â”‚
  â”‚  VST CHAIN                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ 1. â–¶ ReaEQ           [Edit] [Bypass] [âœ•]   â”‚  â”‚
  â”‚  â”‚    Ctrl+Shift+1 â”‚ MIDI CC#21               â”‚  â”‚
  â”‚  â”‚                                              â”‚  â”‚
  â”‚  â”‚ 2. â–¶ W1 Limiter      [Edit] [Bypass] [âœ•]   â”‚  â”‚
  â”‚  â”‚    Ctrl+Shift+2 â”‚ MIDI CC#22               â”‚  â”‚
  â”‚  â”‚                                              â”‚  â”‚
  â”‚  â”‚ 3. â–¶ OrilRiver       [Edit] [Bypass] [âœ•]   â”‚  â”‚
  â”‚  â”‚    Ctrl+Shift+3 â”‚ (ë¯¸ì„¤ì •)                  â”‚  â”‚
  â”‚  â”‚                                              â”‚  â”‚
  â”‚  â”‚          [+ Add VST Plugin]                  â”‚  â”‚
  â”‚  â”‚ Master Bypass: [OFF]  Ctrl+Shift+0          â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                    â”‚
  â”‚  OUTPUT                                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ ğŸŸ¢ Virtual Loop Mic  â– â– â– â– â– â– â–¡â–¡ Vol [=====]  â”‚  â”‚
  â”‚  â”‚ ğŸ”µ Monitor (í—¤ë“œí°)  â– â– â– â– â–¡â–¡â–¡â–¡ Vol [=====]  â”‚  â”‚
  â”‚  â”‚                                              â”‚  â”‚
  â”‚  â”‚ Monitor: [Realtek HD Audio â–¼]               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â± 23ms â”‚ CPU 1.8% â”‚ 48k/Mono â”‚ ğŸŸ¢ Active â”‚ MIDIğŸŸ¢â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  [âš™] â†’ Control Settings íŒ¨ë„ ì—´ê¸°

â–¡ P5-2: DeviceSelector â€” ì…ë ¥/ëª¨ë‹ˆí„° ì¥ì¹˜ ì„ íƒ
â–¡ P5-3: AudioSettings â€” SR, ë²„í¼, ì±„ë„ ëª¨ë“œ
â–¡ P5-4: PluginChainEditor â€” VST ì¶”ê°€/ì‚­ì œ/ìˆœì„œ/ì—ë””í„°
         - ê° í”ŒëŸ¬ê·¸ì¸ í–‰ì— í• ë‹¹ëœ ë‹¨ì¶•í‚¤/MIDI í‘œì‹œ
â–¡ P5-5: OutputPanel â€” Virtual Loop Mic ìƒíƒœ + ë³¼ë¥¨
â–¡ P5-6: LevelMeter â€” ì…ì¶œë ¥ ë ˆë²¨
â–¡ P5-7: PresetManager â€” JSON í”„ë¦¬ì…‹
â–¡ P5-8: ì‹œìŠ¤í…œ íŠ¸ë ˆì´

ì‚°ì¶œë¬¼: ì™„ì „í•œ GUI
```

### Phase 6: ì•ˆì •í™” + ì„¤ì¹˜ í”„ë¡œê·¸ë¨ (Day 28~32)

```
íƒœìŠ¤í¬:
â–¡ P6-1: ì—ëŸ¬ í•¸ë“¤ë§ (USB ë¶„ë¦¬, VST í¬ë˜ì‹œ, ë“œë¼ì´ë²„ ë¯¸ì„¤ì¹˜)
â–¡ P6-2: CPU ìµœì í™”
â–¡ P6-3: í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ (ë§ˆì´í¬, VST, Discord/Zoom/OBS)
â–¡ P6-4: ì¥ì‹œê°„ ì•ˆì •ì„± (8ì‹œê°„+)
â–¡ P6-5: ì„¤ì¹˜ í”„ë¡œê·¸ë¨ (Inno Setup)
â–¡ P6-6: Stream Deck í”ŒëŸ¬ê·¸ì¸ íŒ¨í‚¤ì§• (ì„ íƒì )

ì‚°ì¶œë¬¼: ë¦´ë¦¬ì¦ˆ ë¹Œë“œ + ì„¤ì¹˜ í”„ë¡œê·¸ë¨
```

---

## 6. CLAUDE.md (v3.1)

```markdown
# DirectPipe â€” Claude Code í”„ë¡œì íŠ¸ ê°€ì´ë“œ v3.1

## í”„ë¡œì íŠ¸ ì„¤ëª…
USB ë§ˆì´í¬ìš© VST2/VST3 í˜¸ìŠ¤íŠ¸ + ì´ˆì €ì§€ì—° ë£¨í”„ë°±.
"Virtual Loop Mic" ê°€ìƒ ì¥ì¹˜ë¡œ ì¶œë ¥. Light Host ìˆ˜ì¤€ í˜¸í™˜ì„±.
ê¸°ì¡´ ëŒ€ë¹„ 50~60% ë ˆì´í„´ì‹œ ê°ì†Œ.
í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤, MIDI CC, Stream Deck, HTTP APIë¡œ ì‹¤ì‹œê°„ ì œì–´.

## í•µì‹¬ ì›ì¹™
1. WASAPI Shared ê¸°ë³¸ (ì›ë³¸ ë§ˆì´í¬ ë¹„ë…ì )
2. VST2 + VST3 í˜¸ìŠ¤íŒ…
3. ê³µìœ  ë©”ëª¨ë¦¬ â†’ Virtual Loop Mic ë“œë¼ì´ë²„ ì§ê²°
4. SR/Buffer/Channel ì‚¬ìš©ì ì„ íƒ
5. ì™¸ë¶€ ì œì–´: Hotkey, MIDI, WebSocket, HTTP (ëª¨ë‘ ActionDispatcher ê²½ìœ )

## ê¸°ìˆ  ìŠ¤íƒ
- C++17, JUCE 7+, CMake 3.22+
- WASAPI Shared Mode
- VST2 SDK 2.4 + VST3
- WDK â€” Virtual Loop Mic ë“œë¼ì´ë²„
- SPSC Lock-free Ring Buffer + Windows Shared Memory
- WebSocket (IXWebSocket ë˜ëŠ” uWebSockets)
- HTTP (cpp-httplib)

## ë¹Œë“œ
cmake -B build -DCMAKE_BUILD_TYPE=Release -DVST2_SDK_DIR=/path/to/vstsdk2.4
cmake --build build --config Release

## ì•„í‚¤í…ì²˜
USB Mic â†’ WASAPI Shared â†’ [Mono/Stereo] â†’ VSTChain â†’ OutputRouter
  â†’ SharedMem â†’ [Virtual Loop Mic Driver]
  â†’ WASAPI Out â†’ [Monitor]

ì™¸ë¶€ ì œì–´:
Hotkey/MIDI/WebSocket/HTTP â†’ ControlManager â†’ ActionDispatcher
  â†’ VSTChain (bypass), OutputRouter (volume), PresetManager

## ì½”ë”© ê·œì¹™
- ì˜¤ë””ì˜¤ ì½œë°±: í™ í• ë‹¹ ê¸ˆì§€, ë®¤í…ìŠ¤ ê¸ˆì§€
- ì œì–´ â†’ ì˜¤ë””ì˜¤ í†µì‹ : atomic flags ë˜ëŠ” lock-free queue
- GUI/ì œì–´ëŠ” ê°™ì€ ActionDispatcher ì‚¬ìš© (í†µì¼)
- WebSocket/HTTPëŠ” ë³„ë„ ìŠ¤ë ˆë“œ, ì˜¤ë””ì˜¤ì™€ ë…ë¦½

## ëª¨ë“ˆ
- core/ â†’ IPC ë¼ì´ë¸ŒëŸ¬ë¦¬
- host/ â†’ JUCE ì•±
  - Audio/ â†’ ì˜¤ë””ì˜¤ ì—”ì§„, VST, ì¶œë ¥
  - Control/ â†’ Hotkey, MIDI, WebSocket, HTTP, Action
  - UI/ â†’ GUI
- driver/ â†’ Virtual Loop Mic ì»¤ë„ ë“œë¼ì´ë²„
- streamdeck-plugin/ â†’ Stream Deck í”ŒëŸ¬ê·¸ì¸ (ì„ íƒ)

## ê°œë°œ ìˆœì„œ
Phase 0 (í™˜ê²½) â†’ 1 (Core IPC) â†’ 2 (ì˜¤ë””ì˜¤+VST) â†’
3 (ë“œë¼ì´ë²„) â†’ 4 (ì™¸ë¶€ ì œì–´) â†’ 5 (GUI) â†’ 6 (ì•ˆì •í™”)
```

---

## 7. ì„±ëŠ¥ ëª©í‘œ

| ì§€í‘œ | ëª©í‘œ |
|------|------|
| ë ˆì´í„´ì‹œ (ë²„í¼ 480) | â‰¤ 25ms |
| ë ˆì´í„´ì‹œ (ë²„í¼ 128) | â‰¤ 10ms |
| CPU (VST 0ê°œ) | â‰¤ 2% |
| CPU (VST 3ê°œ) | â‰¤ 8% |
| ë©”ëª¨ë¦¬ (VST 0ê°œ) | â‰¤ 30MB |
| ì—°ì† ë™ì‘ | 8ì‹œê°„+ ê¸€ë¦¬ì¹˜ ì—†ìŒ |
| Hotkey ë°˜ì‘ | â‰¤ 10ms (ë‹¤ìŒ ì˜¤ë””ì˜¤ ì½œë°±ì— ë°˜ì˜) |
| MIDI ë°˜ì‘ | â‰¤ 10ms |
| WebSocket ë°˜ì‘ | â‰¤ 50ms (ë„¤íŠ¸ì›Œí¬ í¬í•¨) |

---

## 8. íƒ€ì„ë¼ì¸

```
Week 1:  Phase 0 (í™˜ê²½) + Phase 1 (Core IPC)
Week 2:  Phase 2 (ì˜¤ë””ì˜¤ ì—”ì§„ + VST í˜¸ìŠ¤íŠ¸)
Week 3:  Phase 3 (Virtual Loop Mic ë“œë¼ì´ë²„)
Week 4:  Phase 4 (ì™¸ë¶€ ì œì–´: Hotkey + MIDI + WebSocket + HTTP)
Week 5:  Phase 5 (GUI)
Week 6:  Phase 6 (ì•ˆì •í™” + ì„¤ì¹˜ í”„ë¡œê·¸ë¨)

ë§ˆì¼ìŠ¤í†¤:
- Week 1 ë: IPC ë™ì‘ âœ“
- Week 2 ë: ë§ˆì´í¬â†’VSTâ†’ê³µìœ ë©”ëª¨ë¦¬ (ì½˜ì†”) âœ“
- Week 3 ë: Virtual Loop Mic ì¥ì¹˜ ë“±ë¡ âœ“
- Week 4 ë: Hotkey/MIDI/StreamDeck ì œì–´ ë™ì‘ âœ“
- Week 5 ë: ì™„ì „í•œ GUI âœ“
- Week 6 ë: ë¦´ë¦¬ì¦ˆ ê°€ëŠ¥ âœ“
```

---

## 9. ë¦¬ìŠ¤í¬ ë° ëŒ€ì‘

| ë¦¬ìŠ¤í¬ | ì‹¬ê°ë„ | ëŒ€ì‘ |
|--------|--------|------|
| USB ë§ˆì´í¬ ì‘ì€ ë²„í¼ ë¯¸ì§€ì› | ì¤‘ | ìë™ ì¡°ì • + ê²½ê³  |
| VST2 SDK ë¼ì´ì„ ìŠ¤ | ì¤‘ | ê¸°ì¡´ ë³´ìœ  SDK ì‚¬ìš© |
| VST2 í¬ë˜ì‹œ | ì¤‘ | SEH ë³´í˜¸ + ìë™ bypass |
| ì»¤ë„ ë“œë¼ì´ë²„ BSOD | ë†’ | ê°€ìƒë¨¸ì‹  + Driver Verifier |
| ë“œë¼ì´ë²„ ì„œëª… | ì¤‘ | í…ŒìŠ¤íŠ¸ ì„œëª… â†’ Attestation |
| WebSocket í¬íŠ¸ ì¶©ëŒ | ë‚® | ìë™ í¬íŠ¸ í´ë°± |
| MIDI ì¥ì¹˜ í•«í”ŒëŸ¬ê·¸ | ë‚® | JUCE MidiInput ì¬ìŠ¤ìº” |
| Hotkey ë‹¤ë¥¸ ì•±ê³¼ ì¶©ëŒ | ë‚® | ë“±ë¡ ì‹¤íŒ¨ ì‹œ ê²½ê³  + ëŒ€ì²´ í‚¤ ì œì•ˆ |
| Stream Deck SDK ë³€ê²½ | ë‚® | HTTP APIë¥¼ ëŒ€ì•ˆìœ¼ë¡œ ìœ ì§€ |
